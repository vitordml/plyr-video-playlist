const PlayerApp={playlist:null,playerContainer:null,playlistItems:[],tracks:[],player:null,initialize(){this.playlist=document.getElementById("playlist"),this.playerContainer=document.getElementById("player_container"),this.createPlayer(),this.initializePlaylistItems(),this.populateAccordionContent(),this.initializeEventListeners(),this.showAllPlaylistItems(),this.initializePlayerEventListeners(),this.initializePlaylistIcon(),this.initializeSearch(),this.playVisibleItem(),this.initialiseSimpleBar(),this.selectFirstVisibleItem()},createPlayer(){this.player=new Plyr(".js-playerx",{controls:'\n    \x3c!-- Player controls HTML --\x3e\n    <button type="button" class="plyr__control plyr__control--overlaid" data-plyr="play">\n        <svg aria-hidden="true" focusable="false">\n          <use xlink:href="#plyr-play"></use>\n        </svg>\n        <span class="plyr__sr-only">Play</span>\n    </button>\n    <div class="plyr__controls">\n        <button class="plyr__controls__item plyr__control" type="button" data-plyr="restart">\n          <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#plyr-restart"></use>\n          </svg>\n          <span class="plyr__tooltip">Restart</span>\n        </button>\n        <button class="plyr__controls__item plyr__control" data-plyr="prev">\n          <svg fill="#ffffff" viewBox="-0.5 0 24 24" xmlns="http://www.w3.org/2000/svg">\n              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>\n              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>\n              <g id="SVGRepo_iconCarrier">\n                <path d="m21.108 23.855-18.708-10.494v10.038.002c0 .331-.268.599-.599.599-.001 0-.001 0-.002 0h-1.2c-.001 0-.001 0-.002 0-.331 0-.599-.268-.599-.599 0-.001 0-.001 0-.002v-22.799-.001c0-.331.268-.599.599-.599h.001 1.2.001c.331 0 .599.268.599.599v.001 10.038l18.708-10.493c.159-.089.348-.141.549-.141.631 0 1.142.511 1.142 1.142v.024-.001 21.665.015c0 .634-.511 1.149-1.143 1.155h-.001c-.202-.002-.39-.057-.552-.152l.005.003z"></path>\n              </g>\n          </svg>\n          <span class="plyr__tooltip">Prev</span>\n        </button>\n        <button class="plyr__controls__item plyr__control" type="button" data-plyr="play">\n          <svg class="icon--pressed" aria-hidden="true" focusable="false">\n              <use xlink:href="#plyr-pause"></use>\n          </svg>\n          <svg class="icon--not-pressed" aria-hidden="true" focusable="false">\n              <use xlink:href="#plyr-play"></use>\n          </svg>\n          <span class="label--pressed plyr__tooltip">Pause</span>\n          <span class="label--not-pressed plyr__tooltip">Play</span>\n        </button>\n        <button class="plyr__controls__item plyr__control" data-plyr="next">\n          <svg fill="#ffffff" viewBox="-0.5 0 24 24" xmlns="http://www.w3.org/2000/svg">\n              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>\n              <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>\n              <g id="SVGRepo_iconCarrier">\n                <path d="m0 22.835v-21.665c0-.007 0-.015 0-.024 0-.63.511-1.141 1.141-1.141.201 0 .391.052.555.144l-.006-.003 18.71 10.493v-10.038c0-.331.268-.6.599-.6h1.2c.332 0 .6.269.6.6v22.799.001c0 .331-.268.599-.599.599h-.001-1.2c-.331 0-.599-.268-.599-.599v-.001-10.038l-18.71 10.494c-.158.091-.347.145-.548.145-.632-.007-1.142-.521-1.142-1.155 0-.004 0-.008 0-.011v.001z"></path>\n              </g>\n          </svg>\n          <span class="plyr__tooltip">Next</span>\n        </button>\n        <div class="plyr__controls__item plyr__progress__container">\n          <div class="plyr__progress">\n              <input data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" aria-label="Seek">\n              <progress class="plyr__progress__buffer" min="0" max="100" value="0">% buffered</progress>\n              <span role="tooltip" class="plyr__tooltip">00:00</span>\n          </div>\n        </div>\n        <div class="plyr__controls__item plyr__time plyr__time--current" aria-label="Current time">00:00</div>\n        <div class="plyr__controls__item plyr__time plyr__time--duration" aria-label="Duration">00:00</div>\n        <button type="button" plyr__controls__item class="plyr__control" aria-label="Mute" data-plyr="mute">\n          <svg class="icon--pressed" role="presentation">\n              <use xlink:href="#plyr-muted"></use>\n          </svg>\n          <svg class="icon--not-pressed" role="presentation">\n              <use xlink:href="#plyr-volume"></use>\n          </svg>\n          <span class="label--pressed plyr__tooltip" role="tooltip">Unmute</span>\n          <span class="label--not-pressed plyr__tooltip" role="tooltip">Mute</span>\n        </button>\n        <div class="plyr__controls__item plyr__volume">\n          <input data-plyr="volume" type="range" min="0" max="1" step="0.05" value="1" autocomplete="off" aria-label="Volume">\n        </div>\n        <button type="button" class="plyr__controls__item plyr__control" data-plyr="fullscreen">\n          <svg class="icon--pressed" role="presentation">\n              <use xlink:href="#plyr-exit-fullscreen"></use>\n          </svg>\n          <svg class="icon--not-pressed" role="presentation">\n              <use xlink:href="#plyr-enter-fullscreen"></use>\n          </svg>\n          <span class="label--pressed plyr__tooltip" role="tooltip">Exit fullscreen</span>\n          <span class="label--not-pressed plyr__tooltip" role="tooltip">Enter fullscreen</span>\n        </button>\n      </div>\n    ',loadSprite:!0,debug:!1,keyboard:{focused:!0,global:!0},i18n:{restart:"Restart"},tooltips:{controls:!0,seek:!0},autoplay:!0,seekTime:10,volume:1,clickToPlay:!0,hideControlsOnPause:!0,disableContextMenu:!0,ratio:"16:9",storage:{enabled:!1},youtube:{modestBranding:!0,controls:!1},playlist:{enabled:!0,scroll:{container:this.playlist,enabled:!0}}})},initializePlaylistItems(){this.playlistItems=Array.from(this.playlist.getElementsByClassName("playlist_item")),this.tracks=this.playlistItems.map(t=>this.createTrackFromPlaylistItem(t)),this.playlistItems.forEach(t=>{t.classList.add("hidden")})},createTrackFromPlaylistItem(t){const e=t.getAttribute("data-type"),s=t.getAttribute("data-video"),l=t.getAttribute("data-category");let i;return i="youtube"===e?{src:s,provider:"youtube"}:"vimeo"===e?{src:s,provider:"vimeo"}:{src:s,provider:"html5"},{title:t.getAttribute("data-title"),artist:t.getAttribute("data-author"),sources:[i],poster:t.getAttribute("data-poster"),category:l}},initializeEventListeners(){const t=this.playlist.getElementsByClassName("filter-button");Array.from(t).forEach(t=>{t.addEventListener("click",t=>{const e=t.target.getAttribute("data-category");this.updateAccordionButtonText(e),this.toggleAccordion(),this.filterPlaylist(e)})});document.querySelector(".accordion-button").addEventListener("click",this.toggleAccordion)},initializePlayerEventListeners(){var t=0;const e=document.querySelector(".playlist-icon");var s=document.querySelector(".player_container .player_text");this.player.on("ready",()=>{this.player.play()}),this.player.on("ready",()=>{if(0==t){const t=this.playlistItems[0],e=this.tracks[0];this.handlePlaylistItemClick(t,e),this.handlePlaylistItemClick(t,e)}t++}),this.player.on("controlshidden",()=>{e.classList.add("hidden"),s.classList.add("hidden")}),this.player.on("controlsshown",()=>{e.classList.remove("hidden"),s.classList.remove("hidden")}),this.player.on("ended",()=>{this.playVisibleItem("next")}),this.player.on("progress",()=>{document.querySelector(".player_container").classList.add("loading")}),this.player.off("canplaythrough",()=>{document.querySelector(".player_container").classList.remove("loading")}),this.player.off("canplay",()=>{document.querySelector(".player_container").classList.remove("loading")}),this.playlistItems.forEach(t=>{t.addEventListener("click",()=>{const e=this.playlistItems.indexOf(t),s=this.tracks[e];this.handlePlaylistItemClick(t,s)})});document.querySelector(".player_container").addEventListener("click",t=>{t.target.matches('button[data-plyr="next"]')&&this.playVisibleItem("next"),t.target.matches('button[data-plyr="prev"]')&&this.playVisibleItem("prev")})},handlePlaylistItemClick(t,e){this.playlistItems.forEach(t=>{t.classList.contains("active")&&(t.classList.remove("active"),t.classList.add("watched"))}),t.classList.add("active");document.querySelector(".text_title").textContent=t.getAttribute("data-title");document.querySelector(".player_text").setAttribute("href",t.getAttribute("data-pUrl")),this.player.source={type:"video",title:e.title,sources:e.sources,poster:e.poster},this.player.play()},populateAccordionContent(){const t=document.querySelector(".accordion-content");t.innerHTML="";const e=document.createElement("div");e.classList.add("filter-button"),e.setAttribute("data-category","All"),e.textContent="All",t.appendChild(e);const s=new Set;this.playlistItems.forEach(e=>{const l=e.getAttribute("data-category");if(l&&""!==l.trim()){l.split(";").forEach(e=>{const l=e.trim();if(""!==l&&!s.has(l)){s.add(l);const e=document.createElement("div");e.classList.add("filter-button"),e.setAttribute("data-category",l),e.textContent=l,t.appendChild(e)}})}});const l=t.getElementsByClassName("filter-button");Array.from(l).forEach(t=>{t.addEventListener("click",t=>{const e=t.target.getAttribute("data-category");this.updateAccordionButtonText(e),this.toggleAccordion(),this.filterPlaylist(e)})})},filterPlaylist(t){this.playlistItems.forEach(t=>{t.classList.remove("active")}),this.playlistItems.forEach(e=>{const s=e.getAttribute("data-category");"All"===t||s.includes(t)?e.classList.remove("hidden"):e.classList.add("hidden")});const e=this.playlist.querySelectorAll(".playlist_item:not(.hidden)[data-category]");if(e.length>0){const t=e[0],s=this.playlistItems.indexOf(t),l=this.tracks[s];t.classList.add("active"),this.player.source={type:"video",title:l.title,sources:l.sources,poster:l.poster},this.player.play()}},showAllPlaylistItems(){this.playlistItems.forEach(t=>{t.classList.remove("hidden")})},toggleAccordion(){document.querySelector(".accordion").classList.toggle("active")},updateAccordionButtonText(t){document.querySelector(".accordion-button").textContent=t},initializePlaylistIcon(){const t=document.querySelector(".playlist-icon"),e=document.querySelector(".col-sm-12.left"),s=document.querySelector(".col-sm-12.right");t.addEventListener("click",()=>{e.classList.toggle("expanded"),s.classList.toggle("hidden")})},initializeSearch(){const t=document.getElementById("searchInput"),e=this.playlist.getElementsByClassName("playlist_item");t.addEventListener("input",(function(t){const s=t.target.value.toLowerCase();Array.from(e).forEach((function(t){const e=t.querySelector(".item_title").textContent.toLowerCase(),l=t.querySelector(".item_director").textContent.toLowerCase();e.includes(s)||l.includes(s)?t.classList.remove("hidden"):t.classList.add("hidden")}))}))},playVisibleItem(t){const e=Array.from(this.playlist.querySelectorAll(".playlist_item:not(.hidden)[data-category]")),s=e.find(t=>t.classList.contains("active"));if(e.length>0){let l;if(s){const i=e.indexOf(s);l="next"===t?(i+1)%e.length:(i-1+e.length)%e.length}else l=0;const i=e[l],a=this.playlistItems.indexOf(i),n=this.tracks[a];this.handlePlaylistItemClick(i,n),i.scrollIntoView({behavior:"smooth",block:"nearest"})}},initialiseSimpleBar(){const t=document.getElementById("playlist");new SimpleBar(t,{autoHide:!0});const e=document.getElementById("acc-content");new SimpleBar(e,{autoHide:!0})},selectFirstVisibleItem(){if(!this.playlist.querySelector(".playlist_item.active")){const t=Array.from(this.playlist.querySelectorAll(".playlist_item:not(.hidden)[data-category]"));if(t.length>0){const e=t[0],s=this.playlistItems.indexOf(e),l=this.tracks[s];this.player.on("ready",()=>{this.handlePlaylistItemClick(e,l)})}}}};document.addEventListener("DOMContentLoaded",()=>{PlayerApp.initialize()});